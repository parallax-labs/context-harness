[db]
path = "./data/ctx.sqlite"

[chunking]
max_tokens = 700
overlap_tokens = 80

# Embedding configuration
# provider: "disabled" | "openai" | "ollama" | "local"
#
# openai  — requires OPENAI_API_KEY env var; model + dims required
# ollama  — requires running Ollama instance; model + dims required
# local   — built-in ONNX models (no API key); model + dims are optional
[embedding]
provider = "disabled"
# model = "text-embedding-3-small"
# dims = 1536
# batch_size = 64
# max_retries = 5
# timeout_secs = 30

# ── OpenAI example ──
# [embedding]
# provider = "openai"
# model = "text-embedding-3-small"
# dims = 1536

# ── Ollama example ──
# [embedding]
# provider = "ollama"
# model = "nomic-embed-text"
# dims = 768
# url = "http://localhost:11434"   # optional, this is the default

# ── Local (fastembed/ONNX) example ──
# [embedding]
# provider = "local"
# model = "all-minilm-l6-v2"      # optional, this is the default (384 dims)
# Supported models: all-minilm-l6-v2, bge-small-en-v1.5, bge-base-en-v1.5,
#   bge-large-en-v1.5, nomic-embed-text-v1, nomic-embed-text-v1.5,
#   multilingual-e5-small, multilingual-e5-base, multilingual-e5-large

[retrieval]
final_limit = 12
hybrid_alpha = 0.6         # weight for vector signal (keyword weight = 1 - alpha)
candidate_k_keyword = 80   # FTS candidates to fetch
candidate_k_vector = 80    # vector candidates to fetch
group_by = "document"
doc_agg = "max"
max_chunks_per_doc = 3

[server]
bind = "127.0.0.1:7331"

# ── Connectors ──────────────────────────────────────────────
# All connector types support named instances. You can have
# multiple of each type. Use `ctx sync all` to sync everything,
# `ctx sync git` to sync all git connectors, or `ctx sync git:platform`
# to sync a specific one.

[connectors.filesystem.local]
root = "./"
include_globs = ["**/*.md", "**/*.txt", "**/*.rs"]
exclude_globs = ["**/target/**", "**/.git/**"]
follow_symlinks = false

# Git connector — ingest docs from a Git repository
# [connectors.git.platform]
# url = "https://github.com/acme/platform.git"   # or local path
# branch = "main"
# root = "docs/"                                  # subdirectory within the repo
# include_globs = ["**/*.md", "**/*.rst"]
# exclude_globs = []
# shallow = true                                  # --depth 1 to save space
# cache_dir = "./data/.git-cache/platform"        # optional, defaults to data/.git-cache/<hash>

# You can add more git repos:
# [connectors.git.auth-service]
# url = "https://github.com/acme/auth-service.git"
# branch = "main"
# include_globs = ["**/*.md"]

# S3 connector — ingest docs from an Amazon S3 bucket
# Requires: AWS_ACCESS_KEY_ID, AWS_SECRET_ACCESS_KEY env vars
# [connectors.s3.runbooks]
# bucket = "acme-docs"
# prefix = "engineering/runbooks/"
# region = "us-east-1"
# include_globs = ["**/*.md", "**/*.json"]
# exclude_globs = []
# endpoint_url = "http://localhost:9000"           # optional, for MinIO/LocalStack
